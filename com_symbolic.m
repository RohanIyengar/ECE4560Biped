syms a1 a2 a3 a4 a5 a6
biped1 = Biped();
my_link_lens = [2.00, 3.625, 3.625, 0.5, 1.75; 2.00, 3.625, 3.625, 0.5, 1.75];
biped1.set_geometry(my_link_lens);
biped1.set_alpha([a1, a2, a3; a4, a5, a6]);
[~, ~, all_frames] = biped1.fwd_kinematics('LEFT_FOOT');
display(all_frames{1,8}.name)
g_l_f = simplify(all_frames{1,8}.mat.getM())
genkai = [  cos(a1 + a2 + a3 - a4 - a5 - a6), sin(a1 + a2 + a3 - a4 - a5 - a6), (29*sin(a2 + a3))/8 - (29*sin(a1 + a2 + a3 - a4 - a5))/8 - (29*sin(a1 + a2 + a3 - a4))/8 + (29*sin(a3))/8; ...
    -sin(a1 + a2 + a3 - a4 - a5 - a6), cos(a1 + a2 + a3 - a4 - a5 - a6), (29*cos(a2 + a3))/8 - (29*cos(a1 + a2 + a3 - a4 - a5))/8 - (29*cos(a1 + a2 + a3 - a4))/8 + (29*cos(a3))/8; ...
                                 0,                                0,                                                                                                         1]
pos_com = biped1.com('LEFT_FOOT')
simplified_pos_com = simplify(pos_com)
pos_com_x = (28*sin(a3))/(25*(cos(a3)^2 + sin(a3)^2)) + (29*cos(a1)^2*cos(a2)*sin(a3) + 29*cos(a1)^2*cos(a3)*sin(a2) + 29*cos(a2)*sin(a1)^2*sin(a3) + 29*cos(a3)*sin(a1)^2*sin(a2) + 29*cos(a1)^2*cos(a2)^2*sin(a3) + 29*cos(a1)^2*sin(a2)^2*sin(a3) + 29*cos(a2)^2*sin(a1)^2*sin(a3) + 29*sin(a1)^2*sin(a2)^2*sin(a3) + 16*cos(a1)*cos(a2)*sin(a3) + 16*cos(a1)*cos(a3)*sin(a2) + 16*cos(a2)*cos(a3)*sin(a1) - 16*sin(a1)*sin(a2)*sin(a3))/(12*(cos(a1)^2*cos(a2)^2*cos(a3)^2 + cos(a1)^2*cos(a2)^2*sin(a3)^2 + cos(a1)^2*cos(a3)^2*sin(a2)^2 + cos(a2)^2*cos(a3)^2*sin(a1)^2 + cos(a1)^2*sin(a2)^2*sin(a3)^2 + cos(a2)^2*sin(a1)^2*sin(a3)^2 + cos(a3)^2*sin(a1)^2*sin(a2)^2 + sin(a1)^2*sin(a2)^2*sin(a3)^2)) - (cos(a1)*cos(a2)*sin(a3) + cos(a1)*cos(a3)*sin(a2) + cos(a2)*cos(a3)*sin(a1) - sin(a1)*sin(a2)*sin(a3))/(3*(cos(a1)^2*cos(a2)^2*cos(a3)^2 + cos(a1)^2*cos(a2)^2*sin(a3)^2 + cos(a1)^2*cos(a3)^2*sin(a2)^2 + cos(a2)^2*cos(a3)^2*sin(a1)^2 + cos(a1)^2*sin(a2)^2*sin(a3)^2 + cos(a2)^2*sin(a1)^2*sin(a3)^2 + cos(a3)^2*sin(a1)^2*sin(a2)^2 + sin(a1)^2*sin(a2)^2*sin(a3)^2)) - (53*(cos(a1)*sin(a2)*sin(a3) - cos(a1)*cos(a2)*cos(a3) + cos(a2)*sin(a1)*sin(a3) + cos(a3)*sin(a1)*sin(a2)))/(600*(cos(a1)^2*cos(a2)^2*cos(a3)^2 + cos(a1)^2*cos(a2)^2*sin(a3)^2 + cos(a1)^2*cos(a3)^2*sin(a2)^2 + cos(a2)^2*cos(a3)^2*sin(a1)^2 + cos(a1)^2*sin(a2)^2*sin(a3)^2 + cos(a2)^2*sin(a1)^2*sin(a3)^2 + cos(a3)^2*sin(a1)^2*sin(a2)^2 + sin(a1)^2*sin(a2)^2*sin(a3)^2)) - ((cos(a1)*cos(a2)*sin(a3) + cos(a1)*cos(a3)*sin(a2) + cos(a2)*cos(a3)*sin(a1) - sin(a1)*sin(a2)*sin(a3))*((29*cos(a4))/8 - (29*sin(a4)*sin(a5))/8 + (29*cos(a4)*cos(a5))/8 + 2))/(6*(cos(a1)^2*cos(a2)^2*cos(a3)^2 + cos(a1)^2*cos(a2)^2*sin(a3)^2 + cos(a1)^2*cos(a3)^2*sin(a2)^2 + cos(a2)^2*cos(a3)^2*sin(a1)^2 + cos(a1)^2*sin(a2)^2*sin(a3)^2 + cos(a2)^2*sin(a1)^2*sin(a3)^2 + cos(a3)^2*sin(a1)^2*sin(a2)^2 + sin(a1)^2*sin(a2)^2*sin(a3)^2)) - (((29*cos(a4))/8 + 2)*(cos(a1)*cos(a2)*sin(a3) + cos(a1)*cos(a3)*sin(a2) + cos(a2)*cos(a3)*sin(a1) - sin(a1)*sin(a2)*sin(a3)))/(6*(cos(a1)^2*cos(a2)^2*cos(a3)^2 + cos(a1)^2*cos(a2)^2*sin(a3)^2 + cos(a1)^2*cos(a3)^2*sin(a2)^2 + cos(a2)^2*cos(a3)^2*sin(a1)^2 + cos(a1)^2*sin(a2)^2*sin(a3)^2 + cos(a2)^2*sin(a1)^2*sin(a3)^2 + cos(a3)^2*sin(a1)^2*sin(a2)^2 + sin(a1)^2*sin(a2)^2*sin(a3)^2)) - (((29*sin(a4))/8 + (29*cos(a4)*sin(a5))/8 + (29*cos(a5)*sin(a4))/8)*(cos(a1)*sin(a2)*sin(a3) - cos(a1)*cos(a2)*cos(a3) + cos(a2)*sin(a1)*sin(a3) + cos(a3)*sin(a1)*sin(a2)))/(6*(cos(a1)^2*cos(a2)^2*cos(a3)^2 + cos(a1)^2*cos(a2)^2*sin(a3)^2 + cos(a1)^2*cos(a3)^2*sin(a2)^2 + cos(a2)^2*cos(a3)^2*sin(a1)^2 + cos(a1)^2*sin(a2)^2*sin(a3)^2 + cos(a2)^2*sin(a1)^2*sin(a3)^2 + cos(a3)^2*sin(a1)^2*sin(a2)^2 + sin(a1)^2*sin(a2)^2*sin(a3)^2)) - (53*cos(a4)*(cos(a1)*cos(a2)*sin(a3) + cos(a1)*cos(a3)*sin(a2) + cos(a2)*cos(a3)*sin(a1) - sin(a1)*sin(a2)*sin(a3)))/(600*(cos(a1)^2*cos(a2)^2*cos(a3)^2 + cos(a1)^2*cos(a2)^2*sin(a3)^2 + cos(a1)^2*cos(a3)^2*sin(a2)^2 + cos(a2)^2*cos(a3)^2*sin(a1)^2 + cos(a1)^2*sin(a2)^2*sin(a3)^2 + cos(a2)^2*sin(a1)^2*sin(a3)^2 + cos(a3)^2*sin(a1)^2*sin(a2)^2 + sin(a1)^2*sin(a2)^2*sin(a3)^2)) - (277*sin(a4)*(cos(a1)*sin(a2)*sin(a3) - cos(a1)*cos(a2)*cos(a3) + cos(a2)*sin(a1)*sin(a3) + cos(a3)*sin(a1)*sin(a2)))/(400*(cos(a1)^2*cos(a2)^2*cos(a3)^2 + cos(a1)^2*cos(a2)^2*sin(a3)^2 + cos(a1)^2*cos(a3)^2*sin(a2)^2 + cos(a2)^2*cos(a3)^2*sin(a1)^2 + cos(a1)^2*sin(a2)^2*sin(a3)^2 + cos(a2)^2*sin(a1)^2*sin(a3)^2 + cos(a3)^2*sin(a1)^2*sin(a2)^2 + sin(a1)^2*sin(a2)^2*sin(a3)^2)) - (53*(cos(a4)*sin(a5) + cos(a5)*sin(a4))*(cos(a1)*sin(a2)*sin(a3) - cos(a1)*cos(a2)*cos(a3) + cos(a2)*sin(a1)*sin(a3) + cos(a3)*sin(a1)*sin(a2)))/(600*(cos(a1)^2*cos(a2)^2*cos(a3)^2 + cos(a1)^2*cos(a2)^2*sin(a3)^2 + cos(a1)^2*cos(a3)^2*sin(a2)^2 + cos(a2)^2*cos(a3)^2*sin(a1)^2 + cos(a1)^2*sin(a2)^2*sin(a3)^2 + cos(a2)^2*sin(a1)^2*sin(a3)^2 + cos(a3)^2*sin(a1)^2*sin(a2)^2 + sin(a1)^2*sin(a2)^2*sin(a3)^2)) + (53*(sin(a4)*sin(a5) - cos(a4)*cos(a5))*(cos(a1)*cos(a2)*sin(a3) + cos(a1)*cos(a3)*sin(a2) + cos(a2)*cos(a3)*sin(a1) - sin(a1)*sin(a2)*sin(a3)))/(600*(cos(a1)^2*cos(a2)^2*cos(a3)^2 + cos(a1)^2*cos(a2)^2*sin(a3)^2 + cos(a1)^2*cos(a3)^2*sin(a2)^2 + cos(a2)^2*cos(a3)^2*sin(a1)^2 + cos(a1)^2*sin(a2)^2*sin(a3)^2 + cos(a2)^2*sin(a1)^2*sin(a3)^2 + cos(a3)^2*sin(a1)^2*sin(a2)^2 + sin(a1)^2*sin(a2)^2*sin(a3)^2)) + (53*(cos(a6)*(sin(a4)*sin(a5) - cos(a4)*cos(a5)) + sin(a6)*(cos(a4)*sin(a5) + cos(a5)*sin(a4)))*(cos(a1)*sin(a2)*sin(a3) - cos(a1)*cos(a2)*cos(a3) + cos(a2)*sin(a1)*sin(a3) + cos(a3)*sin(a1)*sin(a2)))/(600*(cos(a1)^2*cos(a2)^2*cos(a3)^2 + cos(a1)^2*cos(a2)^2*sin(a3)^2 + cos(a1)^2*cos(a3)^2*sin(a2)^2 + cos(a2)^2*cos(a3)^2*sin(a1)^2 + cos(a1)^2*sin(a2)^2*sin(a3)^2 + cos(a2)^2*sin(a1)^2*sin(a3)^2 + cos(a3)^2*sin(a1)^2*sin(a2)^2 + sin(a1)^2*sin(a2)^2*sin(a3)^2)) + (53*(cos(a6)*(cos(a4)*sin(a5) + cos(a5)*sin(a4)) - sin(a6)*(sin(a4)*sin(a5) - cos(a4)*cos(a5)))*(cos(a1)*cos(a2)*sin(a3) + cos(a1)*cos(a3)*sin(a2) + cos(a2)*cos(a3)*sin(a1) - sin(a1)*sin(a2)*sin(a3)))/(600*(cos(a1)^2*cos(a2)^2*cos(a3)^2 + cos(a1)^2*cos(a2)^2*sin(a3)^2 + cos(a1)^2*cos(a3)^2*sin(a2)^2 + cos(a2)^2*cos(a3)^2*sin(a1)^2 + cos(a1)^2*sin(a2)^2*sin(a3)^2 + cos(a2)^2*sin(a1)^2*sin(a3)^2 + cos(a3)^2*sin(a1)^2*sin(a2)^2 + sin(a1)^2*sin(a2)^2*sin(a3)^2)) + (619*cos(a2)*sin(a3))/(1200*(cos(a2)^2 + sin(a2)^2)*(cos(a3)^2 + sin(a3)^2)) + (619*cos(a3)*sin(a2))/(1200*(cos(a2)^2 + sin(a2)^2)*(cos(a3)^2 + sin(a3)^2));
pos_com_y = (29*cos(a1)^2*cos(a2)*cos(a3) + 29*cos(a2)*cos(a3)*sin(a1)^2 - 29*cos(a1)^2*sin(a2)*sin(a3) - 29*sin(a1)^2*sin(a2)*sin(a3) + 29*cos(a1)^2*cos(a2)^2*cos(a3) + 29*cos(a1)^2*cos(a3)*sin(a2)^2 + 29*cos(a2)^2*cos(a3)*sin(a1)^2 + 29*cos(a3)*sin(a1)^2*sin(a2)^2 + 16*cos(a1)*cos(a2)*cos(a3) - 16*cos(a1)*sin(a2)*sin(a3) - 16*cos(a2)*sin(a1)*sin(a3) - 16*cos(a3)*sin(a1)*sin(a2))/(12*(cos(a1)^2*cos(a2)^2*cos(a3)^2 + cos(a1)^2*cos(a2)^2*sin(a3)^2 + cos(a1)^2*cos(a3)^2*sin(a2)^2 + cos(a2)^2*cos(a3)^2*sin(a1)^2 + cos(a1)^2*sin(a2)^2*sin(a3)^2 + cos(a2)^2*sin(a1)^2*sin(a3)^2 + cos(a3)^2*sin(a1)^2*sin(a2)^2 + sin(a1)^2*sin(a2)^2*sin(a3)^2)) + (28*cos(a3))/(25*(cos(a3)^2 + sin(a3)^2)) - (53*(cos(a1)*cos(a2)*sin(a3) + cos(a1)*cos(a3)*sin(a2) + cos(a2)*cos(a3)*sin(a1) - sin(a1)*sin(a2)*sin(a3)))/(600*(cos(a1)^2*cos(a2)^2*cos(a3)^2 + cos(a1)^2*cos(a2)^2*sin(a3)^2 + cos(a1)^2*cos(a3)^2*sin(a2)^2 + cos(a2)^2*cos(a3)^2*sin(a1)^2 + cos(a1)^2*sin(a2)^2*sin(a3)^2 + cos(a2)^2*sin(a1)^2*sin(a3)^2 + cos(a3)^2*sin(a1)^2*sin(a2)^2 + sin(a1)^2*sin(a2)^2*sin(a3)^2)) + (cos(a1)*sin(a2)*sin(a3) - cos(a1)*cos(a2)*cos(a3) + cos(a2)*sin(a1)*sin(a3) + cos(a3)*sin(a1)*sin(a2))/(3*(cos(a1)^2*cos(a2)^2*cos(a3)^2 + cos(a1)^2*cos(a2)^2*sin(a3)^2 + cos(a1)^2*cos(a3)^2*sin(a2)^2 + cos(a2)^2*cos(a3)^2*sin(a1)^2 + cos(a1)^2*sin(a2)^2*sin(a3)^2 + cos(a2)^2*sin(a1)^2*sin(a3)^2 + cos(a3)^2*sin(a1)^2*sin(a2)^2 + sin(a1)^2*sin(a2)^2*sin(a3)^2)) + ((cos(a1)*sin(a2)*sin(a3) - cos(a1)*cos(a2)*cos(a3) + cos(a2)*sin(a1)*sin(a3) + cos(a3)*sin(a1)*sin(a2))*((29*cos(a4))/8 - (29*sin(a4)*sin(a5))/8 + (29*cos(a4)*cos(a5))/8 + 2))/(6*(cos(a1)^2*cos(a2)^2*cos(a3)^2 + cos(a1)^2*cos(a2)^2*sin(a3)^2 + cos(a1)^2*cos(a3)^2*sin(a2)^2 + cos(a2)^2*cos(a3)^2*sin(a1)^2 + cos(a1)^2*sin(a2)^2*sin(a3)^2 + cos(a2)^2*sin(a1)^2*sin(a3)^2 + cos(a3)^2*sin(a1)^2*sin(a2)^2 + sin(a1)^2*sin(a2)^2*sin(a3)^2)) + (((29*cos(a4))/8 + 2)*(cos(a1)*sin(a2)*sin(a3) - cos(a1)*cos(a2)*cos(a3) + cos(a2)*sin(a1)*sin(a3) + cos(a3)*sin(a1)*sin(a2)))/(6*(cos(a1)^2*cos(a2)^2*cos(a3)^2 + cos(a1)^2*cos(a2)^2*sin(a3)^2 + cos(a1)^2*cos(a3)^2*sin(a2)^2 + cos(a2)^2*cos(a3)^2*sin(a1)^2 + cos(a1)^2*sin(a2)^2*sin(a3)^2 + cos(a2)^2*sin(a1)^2*sin(a3)^2 + cos(a3)^2*sin(a1)^2*sin(a2)^2 + sin(a1)^2*sin(a2)^2*sin(a3)^2)) - (((29*sin(a4))/8 + (29*cos(a4)*sin(a5))/8 + (29*cos(a5)*sin(a4))/8)*(cos(a1)*cos(a2)*sin(a3) + cos(a1)*cos(a3)*sin(a2) + cos(a2)*cos(a3)*sin(a1) - sin(a1)*sin(a2)*sin(a3)))/(6*(cos(a1)^2*cos(a2)^2*cos(a3)^2 + cos(a1)^2*cos(a2)^2*sin(a3)^2 + cos(a1)^2*cos(a3)^2*sin(a2)^2 + cos(a2)^2*cos(a3)^2*sin(a1)^2 + cos(a1)^2*sin(a2)^2*sin(a3)^2 + cos(a2)^2*sin(a1)^2*sin(a3)^2 + cos(a3)^2*sin(a1)^2*sin(a2)^2 + sin(a1)^2*sin(a2)^2*sin(a3)^2)) + (53*cos(a4)*(cos(a1)*sin(a2)*sin(a3) - cos(a1)*cos(a2)*cos(a3) + cos(a2)*sin(a1)*sin(a3) + cos(a3)*sin(a1)*sin(a2)))/(600*(cos(a1)^2*cos(a2)^2*cos(a3)^2 + cos(a1)^2*cos(a2)^2*sin(a3)^2 + cos(a1)^2*cos(a3)^2*sin(a2)^2 + cos(a2)^2*cos(a3)^2*sin(a1)^2 + cos(a1)^2*sin(a2)^2*sin(a3)^2 + cos(a2)^2*sin(a1)^2*sin(a3)^2 + cos(a3)^2*sin(a1)^2*sin(a2)^2 + sin(a1)^2*sin(a2)^2*sin(a3)^2)) - (277*sin(a4)*(cos(a1)*cos(a2)*sin(a3) + cos(a1)*cos(a3)*sin(a2) + cos(a2)*cos(a3)*sin(a1) - sin(a1)*sin(a2)*sin(a3)))/(400*(cos(a1)^2*cos(a2)^2*cos(a3)^2 + cos(a1)^2*cos(a2)^2*sin(a3)^2 + cos(a1)^2*cos(a3)^2*sin(a2)^2 + cos(a2)^2*cos(a3)^2*sin(a1)^2 + cos(a1)^2*sin(a2)^2*sin(a3)^2 + cos(a2)^2*sin(a1)^2*sin(a3)^2 + cos(a3)^2*sin(a1)^2*sin(a2)^2 + sin(a1)^2*sin(a2)^2*sin(a3)^2)) - (53*(cos(a4)*sin(a5) + cos(a5)*sin(a4))*(cos(a1)*cos(a2)*sin(a3) + cos(a1)*cos(a3)*sin(a2) + cos(a2)*cos(a3)*sin(a1) - sin(a1)*sin(a2)*sin(a3)))/(600*(cos(a1)^2*cos(a2)^2*cos(a3)^2 + cos(a1)^2*cos(a2)^2*sin(a3)^2 + cos(a1)^2*cos(a3)^2*sin(a2)^2 + cos(a2)^2*cos(a3)^2*sin(a1)^2 + cos(a1)^2*sin(a2)^2*sin(a3)^2 + cos(a2)^2*sin(a1)^2*sin(a3)^2 + cos(a3)^2*sin(a1)^2*sin(a2)^2 + sin(a1)^2*sin(a2)^2*sin(a3)^2)) - (53*(sin(a4)*sin(a5) - cos(a4)*cos(a5))*(cos(a1)*sin(a2)*sin(a3) - cos(a1)*cos(a2)*cos(a3) + cos(a2)*sin(a1)*sin(a3) + cos(a3)*sin(a1)*sin(a2)))/(600*(cos(a1)^2*cos(a2)^2*cos(a3)^2 + cos(a1)^2*cos(a2)^2*sin(a3)^2 + cos(a1)^2*cos(a3)^2*sin(a2)^2 + cos(a2)^2*cos(a3)^2*sin(a1)^2 + cos(a1)^2*sin(a2)^2*sin(a3)^2 + cos(a2)^2*sin(a1)^2*sin(a3)^2 + cos(a3)^2*sin(a1)^2*sin(a2)^2 + sin(a1)^2*sin(a2)^2*sin(a3)^2)) + (53*(cos(a6)*(sin(a4)*sin(a5) - cos(a4)*cos(a5)) + sin(a6)*(cos(a4)*sin(a5) + cos(a5)*sin(a4)))*(cos(a1)*cos(a2)*sin(a3) + cos(a1)*cos(a3)*sin(a2) + cos(a2)*cos(a3)*sin(a1) - sin(a1)*sin(a2)*sin(a3)))/(600*(cos(a1)^2*cos(a2)^2*cos(a3)^2 + cos(a1)^2*cos(a2)^2*sin(a3)^2 + cos(a1)^2*cos(a3)^2*sin(a2)^2 + cos(a2)^2*cos(a3)^2*sin(a1)^2 + cos(a1)^2*sin(a2)^2*sin(a3)^2 + cos(a2)^2*sin(a1)^2*sin(a3)^2 + cos(a3)^2*sin(a1)^2*sin(a2)^2 + sin(a1)^2*sin(a2)^2*sin(a3)^2)) - (53*(cos(a6)*(cos(a4)*sin(a5) + cos(a5)*sin(a4)) - sin(a6)*(sin(a4)*sin(a5) - cos(a4)*cos(a5)))*(cos(a1)*sin(a2)*sin(a3) - cos(a1)*cos(a2)*cos(a3) + cos(a2)*sin(a1)*sin(a3) + cos(a3)*sin(a1)*sin(a2)))/(600*(cos(a1)^2*cos(a2)^2*cos(a3)^2 + cos(a1)^2*cos(a2)^2*sin(a3)^2 + cos(a1)^2*cos(a3)^2*sin(a2)^2 + cos(a2)^2*cos(a3)^2*sin(a1)^2 + cos(a1)^2*sin(a2)^2*sin(a3)^2 + cos(a2)^2*sin(a1)^2*sin(a3)^2 + cos(a3)^2*sin(a1)^2*sin(a2)^2 + sin(a1)^2*sin(a2)^2*sin(a3)^2)) + (619*cos(a2)*cos(a3))/(1200*(cos(a2)^2 + sin(a2)^2)*(cos(a3)^2 + sin(a3)^2)) - (619*sin(a2)*sin(a3))/(1200*(cos(a2)^2 + sin(a2)^2)*(cos(a3)^2 + sin(a3)^2));
pos_com_x_simplified(a1,a2,a3,a4,a5,a6) = (53*cos(a1 + a2 + a3 - a4 - a5 - a6))/600 - (277*sin(a1 + a2 + a3 - a4 - a5))/400 + (1173*sin(a2 + a3))/400 - (389*sin(a1 + a2 + a3 - a4))/300 + (1061*sin(a3))/300 + (42809^(1/2)*cos(a1 + a2 + a3 - atan(200/53)))/600
pos_com_y_simplified(a1,a2,a3,a4,a5,a6) = (1173*cos(a2 + a3))/400 - (277*cos(a1 + a2 + a3 - a4 - a5))/400 - (53*sin(a1 + a2 + a3 - a4 - a5 - a6))/600 - (389*cos(a1 + a2 + a3 - a4))/300 + (1061*cos(a3))/300 + (42809^(1/2)*cos(a1 + a2 + a3 + atan(53/200)))/600
x_check = double(pos_com_x_simplified(.3536, 0, -.3536, -.3369, .0667, .2702))
y_check = double(pos_com_y_simplified(.3536, 0, -.3536, -.3369, .0667, .2702))